FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

WORKDIR /app

RUN pip install --no-cache-dir nicegui==1.4.18 authlib==1.3.1 uvicorn==0.30.1 \
    && pip install --no-cache-dir ollama python-dotenv

# App code and static files (for /logged-out.html and optional static UI)
COPY nicegui_app.py /app/
COPY chat_sidebar.py /app/
COPY web /app/web

EXPOSE 8081

CMD ["python", "nicegui_app.py"]
